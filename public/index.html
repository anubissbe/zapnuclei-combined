<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZAP Test Application</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 { color: #333; }
    .warning {
      background: #ff6b6b;
      color: white;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
    }
    .endpoint {
      background: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 5px;
      border-left: 4px solid #4CAF50;
    }
    .endpoint.vulnerable {
      border-left-color: #ff6b6b;
    }
    code {
      background: #eee;
      padding: 2px 6px;
      border-radius: 3px;
    }
    a { color: #2196F3; }
    form {
      background: white;
      padding: 20px;
      border-radius: 5px;
      margin: 20px 0;
    }
    input {
      padding: 10px;
      margin: 5px;
      border: 1px solid #ddd;
      border-radius: 3px;
    }
    button {
      padding: 10px 20px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>üîç ZAP Security Test Application</h1>
  
  <div class="warning">
    ‚ö†Ô∏è WARNING: This application contains INTENTIONAL security vulnerabilities for testing purposes. 
    DO NOT deploy to production!
  </div>

  <h2>Test Endpoints</h2>
  
  <div class="endpoint vulnerable">
    <strong>XSS Vulnerable Search</strong><br>
    <code>GET /search?q=&lt;script&gt;alert('xss')&lt;/script&gt;</code><br>
    <a href="/search?q=test">Try it: /search?q=test</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Open Redirect</strong><br>
    <code>GET /redirect?url=https://evil.com</code><br>
    <a href="/redirect?url=https://example.com">Try it: /redirect?url=https://example.com</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Information Disclosure</strong><br>
    <code>GET /api/user</code><br>
    <a href="/api/user">Try it: /api/user</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Debug Info Exposure</strong><br>
    <code>GET /api/products?id=1</code><br>
    <a href="/api/products?id=1">Try it: /api/products?id=1</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Directory/File Listing</strong><br>
    <code>GET /files</code><br>
    <a href="/files">Try it: /files</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Insecure Cookie</strong><br>
    <code>GET /login</code><br>
    <a href="/login">Try it: /login</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Sensitive Data in URL</strong><br>
    <code>GET /api/account?token=secret123</code><br>
    <a href="/api/account?token=secret123">Try it: /api/account?token=secret123</a>
  </div>

  <div class="endpoint">
    <strong>Health Check (Safe)</strong><br>
    <code>GET /health</code><br>
    <a href="/health">Try it: /health</a>
  </div>

  <h2>Search Form (XSS Test)</h2>
  <form action="/search" method="GET">
    <input type="text" name="q" placeholder="Search...">
    <button type="submit">Search</button>
  </form>

  <h2>Expected ZAP Findings</h2>
  <ul>
    <li>Missing security headers (X-Frame-Options, CSP, etc.)</li>
    <li>Cookie without HttpOnly/Secure flags</li>
    <li>Reflected XSS</li>
    <li>Open redirect</li>
    <li>Information disclosure</li>
    <li>Missing CSRF tokens</li>
    <li>Application error disclosure</li>
  </ul>

  <h2>Nuclei Test Endpoints</h2>
  
  <div class="endpoint vulnerable">
    <strong>Exposed .env File</strong><br>
    <code>GET /.env</code><br>
    <a href="/.env">Try it: /.env</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Exposed Git Config</strong><br>
    <code>GET /.git/config</code><br>
    <a href="/.git/config">Try it: /.git/config</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Debug/System Info</strong><br>
    <code>GET /debug/info</code><br>
    <a href="/debug/info">Try it: /debug/info</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Exposed Backup SQL</strong><br>
    <code>GET /backup.sql</code><br>
    <a href="/backup.sql">Try it: /backup.sql</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Server Status Page</strong><br>
    <code>GET /server-status</code><br>
    <a href="/server-status">Try it: /server-status</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Exposed Config File</strong><br>
    <code>GET /config.json</code><br>
    <a href="/config.json">Try it: /config.json</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Admin Panel</strong><br>
    <code>GET /admin</code><br>
    <a href="/admin">Try it: /admin</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Exposed Access Logs</strong><br>
    <code>GET /logs/access.log</code><br>
    <a href="/logs/access.log">Try it: /logs/access.log</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Swagger API Docs</strong><br>
    <code>GET /swagger.json</code><br>
    <a href="/swagger.json">Try it: /swagger.json</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>GraphQL Endpoint</strong><br>
    <code>POST /graphql</code><br>
    <a href="/graphql">Try it: /graphql</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Prometheus Metrics</strong><br>
    <code>GET /metrics</code><br>
    <a href="/metrics">Try it: /metrics</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>Actuator Env</strong><br>
    <code>GET /actuator/env</code><br>
    <a href="/actuator/env">Try it: /actuator/env</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>WP Config Backup</strong><br>
    <code>GET /wp-config.php.bak</code><br>
    <a href="/wp-config.php.bak">Try it: /wp-config.php.bak</a>
  </div>

  <div class="endpoint vulnerable">
    <strong>CORS Misconfiguration</strong><br>
    <code>GET /api/cors-test</code><br>
    <a href="/api/cors-test">Try it: /api/cors-test</a>
  </div>

  <h2>Expected Nuclei Findings</h2>
  <ul>
    <li>Exposed .env file with credentials</li>
    <li>Git config disclosure</li>
    <li>Backup file exposure (.sql, .bak)</li>
    <li>Server status page exposed</li>
    <li>Admin panel detection</li>
    <li>Log file exposure</li>
    <li>Swagger/OpenAPI exposure</li>
    <li>GraphQL introspection enabled</li>
    <li>Prometheus metrics exposed</li>
    <li>Spring Actuator endpoints</li>
    <li>WordPress config backup</li>
    <li>CORS misconfiguration</li>
  </ul>
</body>
</html>
